[
 {
  "absolute_value": 0,
  "align_labels_right": 0,
  "css": "/*css for pdf*/\n@media print{\n    .payment_qr img {\n        width:220px !important;\n        height: 100px;\n    }\n}\n\n.payment_qr img {\n    width:220px !important;\n    height: 100px;\n}\n.payment_qr{\n    float:left;\n      width:120px !important;\n    height: 100px;\n}\n \n  \n/*general css*/  \nb{\n    color : initial;\n}\n\np{\n    font-size : 12px !important;\n    word-break:break-all;\n    margin:0px !important;\n}\n\ntable{\n    width:100%;\n}\n\n\n.table, th, td {\n    border: 1px solid black;\n    padding:2px;\n    \n}\n\n.print-format td, .print-format th {\n    padding: 1px !important;\n}\n\n\n\n\n\n\n\n\n\n\n\n",
  "custom_format": 1,
  "default_print_language": "en",
  "disabled": 0,
  "doc_type": "Sales Invoice",
  "docstatus": 0,
  "doctype": "Print Format",
  "font": null,
  "font_size": 14,
  "format_data": null,
  "html": "<html>\n    <body>\n        <h4><center>Tax Invoice</center></h4>\n        <table>\n            <tr>\n                <td colspan=\"7\">\n                <table>\n                    <tr>\n                        <td style=\"border:hidden;width:180px\">  <img src =\"/files/logo-nextfood.jpeg\"></td>\n                        <td style=\"border:hidden;width:280px\">               {% set company_doc = frappe.get_doc(\"Company\",doc.company) %}\n{% set currency_format = frappe.db.get_single_value(\"System Settings\",\"number_format\") %}\n\n{% set bank_details = {} %}\n{% set upi_id = namespace(value=\"\") %}\n{% set bank_name = namespace(value=\"\") %}\n{% set paid_amount = namespace(value=0) %}\n\n{% for doc in company_doc.bank_details_for_printing %}\n\t{% if doc.print_label == \"UPI ID\" %}\n\t\t{% set upi_id.value = doc.print_value %}\n\t{% elif doc.print_label == \"Bank Name\" %}\n\t\t{% set bank_name.value = doc.print_value %}\n\t{% else %}\n\t\t{% set _ = bank_details.update({doc.print_label: doc.print_value}) %}\n\t{% endif %}\n{% endfor %}\n\n{% if doc.rounded_total %}\n\t{% set paid_amount.value = frappe.utils.cint(doc.rounded_total) - frappe.utils.cint(doc.outstanding_amount) %}\n{% else %}\n\t{% set paid_amount.value = frappe.utils.cint(doc.grand_total) - frappe.utils.cint(doc.outstanding_amount) %}\n{% endif %}\n{% set paid_amount.value = frappe.utils.fmt_money(amount=paid_amount.value, format=currency_format, currency=company_doc.default_currency) %}\n\n\n<center class=\"mt-2\">\n\n<div >\n\t\t{% if doc.outstanding_amount != 0 and upi_id.value != ''  %}\n\t\t\t<div style=\"padding-left:0px !important;width:81px !important;\">\n\t\t\t\t<div class=\"payment_qr\">\n\t\t\t\t\t{% set upi_qr_text = 'upi://pay?pa=' ~ upi_id.value ~ '&tn=' ~ doc.name ~ '&cu=INR' %}\n\t\t\t        {% if doc.outstanding_amount < 100000 %}\n\t\t\t\t\t\t{% set upi_qr_text = upi_qr_text ~ '&am=' ~ doc.outstanding_amount %}\n\t\t\t\t\t{% endif %}\n\t\t\t\t\t{{ web_block('UPI QR Code', values={'upi_qr_text': upi_qr_text  }) }}\n\t\t\t\t</div>\n\t\t\t\n\t\t\t</div>\n\t\t{% endif %}\n\t\t{% if bank_details %}\n\t\t\t<div style=\"padding-top:5px !important;padding-left:0px !important\">\n\t\t\t\t<p><b>Bank Details</b></p>\n\t\t\t\t<p>{{ bank_name.value }}</p>\n\t\t\t\t\n\t\t\t\t{% for key,value in bank_details.items() %}\n\t\t\t\t\t{% if value != None %}\n\t\t\t\t\t\t<p>{{ key }} : {{ value }}</p>\n\t\t\t\t\t{% endif %}\n\t\t\t\t{% endfor %}\n\t\t\t</div>\n\t\t{% endif %}\n</div>\n</center></td>\n<td style=\"border:hidden;\">       <div style=\"padding-bottom:5px !important;text-align:right\">\n\t<!-- Billing Address -->\n\n\t\t<p><b>Company Address</b></p>\n\n\t{% if doc.company %}\n\t\t<p><b>{{ doc.company }}</b></p>\n\t{% endif %}\n\n\t<p>{{ doc.company_address_display if doc.company_address_display else '' }}</p>\n\n\n</div></td>\n                    </tr>\n                   \n                </table>\n                </td>\n            </tr>\n           <tr>\n               <td colspan=\"7\">\n                   <div class=\"row\">\n                       <div class=\"col-xs-8\">\n                           <div style=\"padding-bottom:5px !important\">\n\t<!-- Billing Address -->\n\t\n\t{% if doc.customer_name %}\n\t\t<p><b>Customer Name : {{ doc.customer_name }}</b></p>\n\t{% endif %}\n<p><b>Customer Address :</b></p>\n\t<p>{{ doc.address_display if doc.address_display else '' }}</p>\n\n\n\t\n</div>\n                       </div>\n                          <div class=\"col-xs-4\">\n                               <p> <b>Sales Invoice No :</b> {{ doc.name }}</p>\n              <p> <b>Date :</b> {{ doc.get_formatted(\"posting_date\") }}</p>\n               <p> <b>Payment Due Date :</b> {{ doc.get_formatted(\"due_date\") }}</p>\n                <p> <b>Mobile No :</b> {{ frappe.db.get_value(\"Contact\",doc.contact_person,'mobile_no') }}</p>\n\n                       </div>\n                   </div>\n               </td>\n           </tr>\n           <tr>\n               <th style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">Sr</th>\n               <th style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">Item</th>\n               <th style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">HSN/SAC\t</th>\n               <th style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">Quantity</th>\n               <th style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">UOM</th>\n               <th style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">Rate</th>\n               <th style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">Grand Total</th>\n           </tr>\n           {% for item in doc.items %}\n           {% if item.custom_is_companny_provided_item == 0 %}\n           <tr>\n               <td style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">{{ item.idx  or 0}}</td>\n               <td style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">{{ item.item_code  or ''}}</td>\n               <td style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">{{ item.gst_hsn_code  or ''}}</td>\n               <td style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">{{ item.qty  or 0}}</td>\n               <td style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">{{ item.uom  or 0}}</td>\n               <td style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:right\">\n                  {% if item.igst_rate %}\n    {{ (item.rate + (item.rate * item.igst_rate / 100)) | round(2) }}\n{% elif item.cgst_rate and item.sgst_rate %}\n    {{ (item.rate + (item.rate * item.cgst_rate / 100) + (item.rate * item.sgst_rate / 100)) | round(2) }}\n{% else %}\n    {{ item.rate | round(2) }}\n{% endif %}\n\n\n               </td>\n\n               <td class=\"text-right\" style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:right\">\n           {% if item.igst_rate %}\n    {{ (item.qty * (item.rate + (item.rate * item.igst_rate / 100))) | round(2) }}\n{% elif item.cgst_rate and item.sgst_rate %}\n    {{ (item.qty * (item.rate + (item.rate * item.cgst_rate / 100) + (item.rate * item.sgst_rate / 100))) | round(2) }}\n{% else %}\n    {{ (item.qty * item.rate) | round(2) }}\n{% endif %}\n\n</td>\n               \n           </tr>\n           {% endif %}\n           {% endfor %}\n           <tr>\n               <td colspan=\"6\"><p><b>{{ doc.in_words or '' }}</b></p></td>\n               \n               <td class=\"text-center\" style=\"text-align:right\"><b>{{ doc.rounded_total or '' }}</b></td>\n           </tr>\n            <tr>\n               <td colspan=\"7\">\n                   {{ doc.gst_breakup_table }}\n               </td>\n           </tr>\n           <tr>\n               <th  style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">Date</th>\n               <th style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">Invoice No.</th>\n               <th  class=\"text-right\" style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif\">Bill Amt</th>\n               <th  class=\"text-right\" style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif\">Payment Amt</th>\n               <th colspan=\"3\" class=\"text-right\" style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif\">Balance Amount</th>\n           </tr>\n          \n           \n    {% set sales_list = frappe.db.get_all(\"Sales Invoice\", \n    filters={'customer': doc.customer}, \n    fields=['*'], \n    order_by='posting_date desc, posting_time desc', \n    limit=5) %}\n\n{% set sales_ledger = frappe.db.get_all(\"GL Entry\", \n    filters={'party': doc.customer, 'voucher_type': \"Sales Invoice\", \"is_cancelled\": 0}, \n    fields=['debit'], \n    order_by='posting_date desc, creation desc') %}\n\n{% set journal_ledger = frappe.db.get_all(\"GL Entry\", \n    filters={'party': doc.customer, 'voucher_type': [\"in\", [\"Journal Entry\", \"Payment Entry\"]], \"is_cancelled\": 0}, \n    fields=['credit'], \n    order_by='posting_date desc, creation desc') %}\n\n\n{% set a = namespace(jl_amt=0, sl_amt=0) %}\n\n{% for jl in journal_ledger %}\n    {% set a.jl_amt = a.jl_amt + (jl.credit or 0) %}\n{% endfor %}\n\n{% for sl in sales_ledger %}\n    {% set a.sl_amt = a.sl_amt + (sl.debit or 0) %}\n{% endfor %}\n\n{% set b = namespace (count= 0) %}\n   {% for sales_invoice in sales_list %}\n           {% if sales_invoice.status != \"Cancelled\"  %}\n         {% set b.count = b.count + 1 %}\n           <tr>\n               <td style=\"text-align:center\" > {{ sales_invoice.posting_date}}</td>\n               <td style=\"text-align:center\">{{ sales_invoice.name}}</td>\n                <td  class=\"text-right\">{% if sales_invoice.disable_rounded_total %} {{ sales_invoice.grand_total }}  {% else %} {{ sales_invoice.rounded_total}}{% endif %}</td>\n                <td  class=\"text-right\">{% if sales_invoice.disable_rounded_total %} {{ sales_invoice.grand_total - sales_invoice.outstanding_amount }}  {% else %} {{ sales_invoice.rounded_total - sales_invoice.outstanding_amount}}{% endif %}</td>\n               \n               <td colspan=\"3\" class=\"text-right\">{{ sales_invoice.outstanding_amount}}</td>\n               \n           </tr>\n           {% endif %}\n           {% endfor %}\n           <tr>\n    <th colspan=\"7\" style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">\n        Crates Details\n    </th>\n</tr>\n<tr>\n   \n    <th colspan=\"3\" style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">Item Name</th>\n    <th colspan=\"2\" style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">Out Qty</th>\n    <th  style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">In Qty</th>\n    <th  style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">Balance Qty</th>\n</tr>\n\n{% set customer_details = frappe.db.sql(\"\"\"\n    SELECT \n        sii.item_code,\n        si.customer,\n        SUM(sii.qty) AS total_qty,\n        SUM(sii.custom_return_qty) AS total_return_qty\n    FROM `tabDelivery Note Item` sii\n    JOIN `tabDelivery Note` si ON sii.parent = si.name\n    WHERE si.customer = %(customer)s \n      AND sii.custom_is_companny_provided_item = 1\n    GROUP BY sii.item_code, si.customer\n\"\"\", {\"customer\": doc.customer}, as_dict=True) %}\n\n  {% for return_item in customer_details %}\n  <tr>\n     \n      <td style=\"text-align:center\" colspan=\"3\">{{ return_item.item_code }}</td>\n      <td style=\"text-align:center\" colspan=\"2\">{{ return_item.total_qty }}</td>\n      <td style=\"text-align:center\">{{ return_item.total_return_qty }}</td>\n      <td style=\"text-align:center\">{{ return_item.total_qty - return_item.total_return_qty }} </td>\n  </tr>\n  {% endfor %}\n        </table>\n    \n\n\n\n    </body>\n</html>",
  "line_breaks": 0,
  "margin_bottom": 15.0,
  "margin_left": 15.0,
  "margin_right": 15.0,
  "margin_top": 15.0,
  "modified": "2025-01-17 19:05:22.968896",
  "module": "Nextfood",
  "name": "Sales Invoice",
  "page_number": "Hide",
  "print_format_builder": 0,
  "print_format_builder_beta": 0,
  "print_format_type": "Jinja",
  "raw_commands": null,
  "raw_printing": 0,
  "show_section_headings": 0,
  "standard": "No"
 },
 {
  "absolute_value": 0,
  "align_labels_right": 0,
  "css": "/*css for pdf*/\n@media print{\n    .payment_qr img {\n        width:81px !important;\n        height: 81px;\n    }\n}\n\n.payment_qr img {\n    width:81px !important;\n    height: 81px;\n}\n.payment_qr{\n    float:left;\n}\n \n  \n/*general css*/  \nb{\n    color : initial;\n}\n\np{\n    font-size : 12px !important;\n    word-break:break-all;\n    margin:0px !important;\n}\n\ntable{\n    width:100%;\n}\n\n\n.table, th, td {\n    border: 1px solid black;\n    padding:2px;\n    \n}\n\n.print-format td, .print-format th {\n    padding: 1px !important;\n}\n\n\n\n\n\n\n\n\n\n\n\n",
  "custom_format": 1,
  "default_print_language": "en",
  "disabled": 0,
  "doc_type": "Purchase Invoice",
  "docstatus": 0,
  "doctype": "Print Format",
  "font": null,
  "font_size": 14,
  "format_data": null,
  "html": "<html>\n    <body>\n        <h4><center>Purchase Invoice</center></h4>\n        <table>\n            <tr>\n                <td colspan=\"11\">\n                    <div class=\"row\">\n                        <div class=\"col-xs-4\">\n                            <img src =\"/files/Freshina-Final-removebg-preview.png\">\n                        </div>\n                        <div class=\"col-xs-8 text-right\">\n                           <div style=\"padding-bottom:5px !important\">\n\t<!-- Billing Address -->\n\n\t\t<p>Company Address</p>\n\n\t{% if doc.company %}\n\t\t<p><b>{{ doc.company }}</b></p>\n\t{% endif %}\n\n\t<p>{{ doc.billing_address_display if doc.billing_address_display else '' }}</p>\n\n\n</div>\n\n                        </div>\n\n                    </div>\n                </td>\n            </tr>\n           <tr>\n               <td colspan=\"11\">\n                   <div class=\"row\">\n                       <div class=\"col-xs-8\">\n                           <div style=\"padding-bottom:5px !important\">\n\t<!-- Billing Address -->\n\t\n\t{% if doc.supplier_name %}\n\t\t<p><b>Party Name</b> : {{ doc.supplier_name }}</p>\n\t{% endif %}\n\n\t<p>{{ doc.address_display if doc.address_display else '' }}</p>\n\n\n\t\n</div>\n                       </div>\n                          <div class=\"col-xs-4\">\n              <p> <b>Date :</b> {{ doc.get_formatted(\"posting_date\") }}</p>\n             \n\n                       </div>\n                   </div>\n               </td>\n           </tr>\n           <tr>\n               <td style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">Sr</td>\n               <td style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">Item</td>\n               <td style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">Receipt Date</td>\n               <td style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">Quantity</td>\n               <td style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">FAT %</th>\n               <td style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">CLR</th>\n               <td style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">SNF % </td>\n               <td style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">Fat Kg</td>\n               <td style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">SNF kg</td>\n               <td style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">Rate</td>\n               <td style=\"font-family:Inter, Helvetica Neue, Helvetica, Arial, Open Sans, sans-serif;text-align:center\">Amount</td>\n               \n           </tr>\n        {% set grouped_items = doc.items | groupby('custom_bm_or_cw') %}\n\n{% for bm_or_cw, items in grouped_items %}\n    {% set total_qty = items | sum(attribute='qty') %}\n    {% set total_fat_kg = items | sum(attribute='custom_fat_kg') %}\n    {% set total_snf_kg = items | sum(attribute='custom_snf_kg') %}\n    {% set total_amount = items | sum(attribute='amount') %}\n\n    <tr>\n        <td colspan=\"11\" style=\"text-align:left; font-weight:bold; font-family:Inter, Helvetica, Arial;\">\n            {{ bm_or_cw or '' }} \n        </td>\n    </tr>\n    {% for item in items %}\n        <tr>\n            <td style=\"text-align:center\">{{ item.idx or 0 }}</td>\n            <td style=\"text-align:center\"> {{ item.item_code or '' }}</td>\n            <td style=\"text-align:center\">\n                {{ frappe.utils.formatdate(frappe.db.get_value(\"Purchase Receipt\", item.purchase_receipt, \"posting_date\"), \"dd-mm-yyyy\") }}\n            </td>\n            <td style=\"text-align:center\">{{ \"{:.2f}\".format(item.qty or 0) }}</td>\n            <td style=\"text-align:center\">{{ \"{:.2f}\".format(item.custom_fat or 0) }} %</td>\n            <td style=\"text-align:center\">{{ \"{:.2f}\".format(item.custom_clr or 0) }}</td>\n            <td style=\"text-align:center\">{{ \"{:.2f}\".format(item.custom_snf or 0) }} %</td>\n            <td style=\"text-align:center\">{{ \"{:.2f}\".format(item.custom_fat_kg or 0) }}</td>\n            <td style=\"text-align:center\">{{ \"{:.2f}\".format(item.custom_snf_kg or 0) }}</td>\n            <td style=\"text-align:center\">{{ \"{:.2f}\".format(item.rate or 0) }}</td>\n            <td style=\"text-align:center\">{{ \"{:.2f}\".format(item.amount or 0) }}</td>\n        </tr>\n    {% endfor %}\n    <tr style=\"font-weight:bold;\">\n        <td colspan=\"3\" style=\"text-align:right;\">Total:</td>\n        <td style=\"text-align:center\">{{ \"{:.2f}\".format(total_qty or 0) }}</td>\n        <td></td> <!-- Empty for FAT % -->\n        <td></td> <!-- Empty for CLR -->\n        <td></td> <!-- Empty for SNF % -->\n        <td style=\"text-align:center\">{{ \"{:.2f}\".format(total_fat_kg or 0) }}</td>\n        <td style=\"text-align:center\">{{ \"{:.2f}\".format(total_snf_kg or 0) }}</td>\n        <td></td> <!-- Empty for Rate -->\n        <td style=\"text-align:center\">{{ \"{:.2f}\".format(total_amount or 0) }}</td>\n    </tr>\n  {% for taxes in doc.taxes %}\n {% if \"Commission on Sales\" in taxes.account_head %}\n  <tr style=\"font-weight:bold;\">\n    <td colspan=\"3\" style=\"text-align:right;\">Commission ({{ taxes.rate }}%):</td>\n    <td style=\"text-align:center\"></td>\n    <td></td> <!-- Empty for FAT % -->\n    <td></td> <!-- Empty for CLR -->\n    <td></td> <!-- Empty for SNF % -->\n    <td style=\"text-align:center\"></td>\n    <td style=\"text-align:center\"></td>\n    <td></td> <!-- Empty for Rate -->\n    <td style=\"text-align:center\">\n        {{ ((total_amount * taxes.rate) / 100) | round(2) }}\n    </td>\n  </tr>\n  {% endif %}\n{% endfor %}\n\n\n\n{% endfor %}\n\n\n           <tr>\n               <td colspan=\"10\"><p>{{ doc.in_words or '' }}</p></td>\n               \n               <td class=\"text-center\">{{ \"{:.2f}\".format( doc.rounded_total or 0) }}</td>\n           </tr>\n         \n           \n\n        </table>\n    </body>\n</html>",
  "line_breaks": 0,
  "margin_bottom": 15.0,
  "margin_left": 15.0,
  "margin_right": 15.0,
  "margin_top": 15.0,
  "modified": "2025-03-03 13:54:10.784675",
  "module": "Nextfood",
  "name": "Purchase Invoice",
  "page_number": "Hide",
  "print_format_builder": 0,
  "print_format_builder_beta": 0,
  "print_format_type": "Jinja",
  "raw_commands": null,
  "raw_printing": 0,
  "show_section_headings": 0,
  "standard": "No"
 },
 {
  "absolute_value": 0,
  "align_labels_right": 0,
  "css": null,
  "custom_format": 0,
  "default_print_language": "en",
  "disabled": 0,
  "doc_type": "Delivery Trip",
  "docstatus": 0,
  "doctype": "Print Format",
  "font": null,
  "font_size": 14,
  "format_data": "[{\"fieldname\": \"print_heading_template\", \"fieldtype\": \"Custom HTML\", \"options\": \"<div class=\\\"print-heading\\\">\\t\\t\\t\\t<h2><div>Delivery Trip</div><br><small class=\\\"sub-heading\\\">{{ doc.name }}</small>\\t\\t\\t\\t</h2></div>\"}, {\"fieldtype\": \"Section Break\", \"label\": \"\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"naming_series\", \"print_hide\": 0, \"label\": \"Series\"}, {\"fieldname\": \"company\", \"print_hide\": 0, \"label\": \"Company\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"email_notification_sent\", \"print_hide\": 0, \"label\": \"Initial Email Notification Sent\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Delivery Details\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"driver\", \"print_hide\": 0, \"label\": \"Driver\"}, {\"fieldname\": \"driver_name\", \"print_hide\": 0, \"label\": \"Driver Name\"}, {\"fieldname\": \"driver_email\", \"print_hide\": 0, \"label\": \"Driver Email\"}, {\"fieldname\": \"driver_address\", \"print_hide\": 0, \"label\": \"Driver Address\"}, {\"fieldname\": \"total_distance\", \"print_hide\": 0, \"label\": \"Total Estimated Distance\"}, {\"fieldname\": \"uom\", \"print_hide\": 0, \"label\": \"Distance UOM\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"vehicle\", \"print_hide\": 0, \"label\": \"Vehicle\"}, {\"fieldname\": \"departure_time\", \"print_hide\": 0, \"label\": \"Departure Time\"}, {\"fieldname\": \"employee\", \"print_hide\": 0, \"label\": \"Employee\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Delivery Stops\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"delivery_stops\", \"print_hide\": 0, \"label\": \"Delivery Stop\", \"visible_columns\": [{\"fieldname\": \"customer\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"custom_territory\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"locked\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"customer_address\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"grand_total\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"email_sent_to\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"customer_contact\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"estimated_arrival\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"uom\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"details\", \"print_width\": \"\", \"print_hide\": 0}]}, {\"fieldname\": \"calculate_arrival_time\", \"print_hide\": 0, \"label\": \"Calculate Estimated Arrival Times\"}, {\"fieldname\": \"optimize_route\", \"print_hide\": 0, \"label\": \"Optimize Route\"}, {\"fieldtype\": \"Section Break\", \"label\": \"\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"{% set grouped_items = {} %}\\n{% for stop in doc.delivery_stops %}\\n    {% set delivery_note = frappe.get_doc(\\\"Delivery Note\\\", stop.delivery_note) %}\\n    {% for item in delivery_note.items %}\\n        {% if item.item_code in grouped_items %}\\n            {% set _ = grouped_items[item.item_code].update({\\n                \\\"qty\\\": grouped_items[item.item_code].qty + item.qty\\n            }) %}\\n        {% else %}\\n            {% set _ = grouped_items.update({\\n                item.item_code: {\\n                    \\\"item_code\\\": item.item_code,\\n                    \\\"uom\\\": item.uom,\\n                    \\\"qty\\\": item.qty\\n                }\\n            }) %}\\n        {% endif %}\\n    {% endfor %}\\n{% endfor %}\\n\\n<table class=\\\"table table-bordered\\\">\\n    <tr>\\n        <th>Item Code</th>\\n        <th>UOM</th>\\n        <th>Qty</th>\\n    </tr>\\n    {% for item_code, item in grouped_items.items() %}\\n    <tr>\\n        <td>{{ item.item_code }}</td>\\n        <td>{{ item.uom }}</td>\\n        <td>{{ item.qty }}</td>\\n    </tr>\\n    {% endfor %}\\n</table>\\n\"}]",
  "html": null,
  "line_breaks": 0,
  "margin_bottom": 15.0,
  "margin_left": 15.0,
  "margin_right": 15.0,
  "margin_top": 15.0,
  "modified": "2025-01-01 16:41:19.590044",
  "module": "Nextfood",
  "name": "Delivery Trip",
  "page_number": "Hide",
  "print_format_builder": 0,
  "print_format_builder_beta": 0,
  "print_format_type": "Jinja",
  "raw_commands": null,
  "raw_printing": 0,
  "show_section_headings": 0,
  "standard": "No"
 }
]